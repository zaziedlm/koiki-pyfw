# プロダクト概要

KOIKI-FW v0.6.0 は、モダンなセキュリティ実装を備えた堅牢でスケーラブルなWebアプリケーション構築のためのエンタープライズ級FastAPIアプリケーションフレームワークです。

## 主要機能

- **エンタープライズセキュリティ**: JWT認証、リフレッシュトークン、パスワードリセット、ログイン試行制限、RBAC（ロールベースアクセス制御）、レート制限
- **モジュラー認証システム**: 基本認証、パスワード管理、トークン管理
- **モダン技術スタック**: FastAPI、SQLAlchemy（非同期）、Pydantic、Redis、Celery、structlog、Prometheus
- **クリーンアーキテクチャ**: API層、Service層、Repository層の明確な関心事の分離
- **非同期処理**: 高パフォーマンスな非同期操作
- **型安全性**: Pydanticと型ヒントによる開発効率と安全性の向上
- **テスト容易性**: 依存性注入による簡単なテスト実装
- **監視・ログ**: 構造化ログ、監査ログ、Prometheus連携
- **フルスタック**: FastAPIバックエンドとNext.jsフロントエンド

## アーキテクチャ思想

フレームワークは以下の階層アーキテクチャパターンに従います：
- **libkoiki/**: 事前実装済み機能を含むフレームワークコアライブラリ（User、Role、Permission、Todo管理）
- **app/**: アプリケーション固有の拡張とカスタマイズ
- **frontend/**: TypeScriptとTailwind CSSを使用したNext.js Reactアプリケーション

この設計により、エンタープライズ級のセキュリティとスケーラビリティを維持しながら迅速な開発が可能になります。

## 推奨フロントエンド実装

### Next.js 実装 (frontend/)

現在 `frontend/` ディレクトリに実装されているNext.jsアプリケーションは、KOIKI-FWの推奨フロントエンド実装の一つです。

#### 技術構成
- **Next.js 15.5.2**: App Routerを使用したモダンなReactフレームワーク
- **React 19.1.0**: 最新のReactライブラリ
- **TypeScript**: 完全な型安全性
- **Tailwind CSS 4**: ユーティリティファーストのCSSフレームワーク
- **Radix UI**: アクセシブルなコンポーネントプリミティブ
- **TanStack Query**: サーバー状態管理
- **Zustand**: クライアント状態管理
- **React Hook Form + Zod**: フォーム処理とバリデーション

#### アーキテクチャ特徴

**1. Cookie認証対応**
- CSRF保護付きのCookie認証システム
- セキュアなセッション管理
- 自動トークンリフレッシュ

**2. モジュラー設計**
```
src/
├── app/                 # Next.js App Router
├── components/          # 再利用可能なUIコンポーネント
│   ├── auth/           # 認証関連コンポーネント
│   ├── layout/         # レイアウトコンポーネント
│   ├── tasks/          # タスク管理コンポーネント
│   └── ui/             # 基本UIコンポーネント
├── hooks/              # カスタムReactフック
├── lib/                # ユーティリティライブラリ
├── stores/             # 状態管理
└── types/              # TypeScript型定義
```

**3. API統合**
- FastAPIバックエンドとの完全統合
- Cookie認証によるセキュアなAPI通信
- 型安全なAPIクライアント実装
- エラーハンドリングとローディング状態管理

**4. セキュリティ機能**
- CSRF保護
- XSS対策
- セキュアなCookie設定
- 認証ガード付きルート保護

**5. 開発者体験**
- Hot Reload対応
- TypeScript完全サポート
- ESLint/Prettier設定済み
- コンポーネントライブラリ統合

#### 主要コンポーネント

**認証システム**
- ログイン/登録フォーム
- パスワード表示切り替え
- バリデーション付きフォーム
- 自動リダイレクト

**ダッシュボード**
- 統計カード表示
- 最近のアクティビティ
- クイックアクション
- レスポンシブデザイン

**タスク管理**
- CRUD操作対応
- リアルタイム更新
- フィルタリング・検索
- ドラッグ&ドロップ対応

#### 設定とカスタマイズ

**環境設定**
```typescript
// config.ts
export const config = {
  api: {
    url: process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000',
    prefix: '/api/v1',
  },
  auth: {
    cookieAuth: {
      enabled: true,
      csrfProtection: true,
    },
  },
}
```

**テーマ対応**
- ライト/ダークモード切り替え
- システム設定連動
- カスタムカラーパレット

この実装は、エンタープライズアプリケーションに必要な機能を網羅しており、KOIKI-FWバックエンドとの完全な統合を提供します。開発者は、この実装を参考にして独自のフロントエンドアプリケーションを構築することができます。

## フルスタック統合の特徴

### バックエンド・フロントエンド連携
- **統一認証システム**: Cookie認証とJWT認証の両方をサポート
- **CSRF保護**: フロントエンドとバックエンド間の完全なCSRF対策
- **型安全な通信**: TypeScriptとPydanticによる型安全なAPI通信
- **リアルタイム同期**: TanStack Queryによる効率的なデータ同期

### 開発・運用統合
- **Docker統合**: バックエンド・フロントエンド・データベースの統合Docker環境
- **共通設定管理**: 環境変数による統一設定管理
- **統合テスト**: フルスタックでのE2Eテスト対応
- **統合監視**: 両層にわたる包括的な監視・ログ収集

### セキュリティ統合
- **多層防御**: バックエンドとフロントエンドでの多重セキュリティ対策
- **認証ガード**: Next.js MiddlewareとFastAPI依存性注入による認証制御
- **RBAC統合**: バックエンドの権限システムとフロントエンドの表示制御の連携
- **セキュリティヘッダー**: 両層での適切なセキュリティヘッダー設定